1. Video Gen & Preview Breaks/Fixes (Core Issue from Screenshot)
Broken: Backend gens (logs show success) but UI black (player at 0:00 empty—URL expired/invalid per tools, or embed error like wrong src/MIME in VideoPostCardSimple.tsx). From tools: Common "failed generation" or black from prompt/model (gemini-2.0 vs. 1.5), URL expiry (embed immediately), safety blocks (prompt too vague).
Fixes: In videoService.js, cache URLs (Replit DB with 48hr TTL to beat expiry); in frontend, add retry/error handling on <video>. <ul> <li>Code Fix (Backend - Cache URL): <pre><code class="language-javascript">// In videoService.js, after gen const videoUrl = response.video_url; // Assume returns this await db.set(`video_${userId}_${postId}`, videoUrl, { EX: 172800 }); // 48hrs, use Replit DB </code></pre> </li> <li>Code Fix (Frontend - Embed with Retry): <pre><code class="language-javascript">// In VideoPostCardSimple.tsx const [videoSrc, setVideoSrc] = useState(null); const [loadError, setLoadError] = useState(null); // On gen success setVideoSrc(data.videoUrl); return ( {videoSrc &#x26;&#x26; ( &#x3C;video src={videoSrc} controls onError={() => setLoadError('Load failed—retrying...')} onLoadedData={() => console.log('Video loaded')} autoPlay /> )} {loadError &#x26;&#x26; &#x3C;button onClick={() => setVideoSrc(videoSrc + '?ts=' + Date.now())}>Retry Preview&#x3C;/button>} // Force reload ); </code></pre> </li> <li>Test: Run gen, check player loads (tools confirmed MP4 embeds work if URL fresh). If "safety" error (from snippets), adjust prompt (e.g., add harmless flag).</li> </ul> </video>
2. Sessions/Cookies (Stability for Gens)
Broken: Drops mid-gen/onboard (no Redis, Replit restarts wipe; ties to your fail if session lost key context).
Fix: Implement Redis or Replit DB for persistence; auto-save gen state.
3. Quotas (Prevent Leaks to Fails)
Broken: Unhooked from gens (exceed limits, but your fail's not quota—still, add to avoid).
Fix: Pre-check: if (!await quotaManager.canGenerateVideo(userId)) throw 'Quota hit';.
4. Auto-Posting (Integrate with Gen)
Broken: Mocks incomplete, no queue for gen outputs (videos don't post with sound/CTA).
Fix: After gen, push to posting_queue.ts with retries; align to events.
5. Onboarding/OAuth (JTBD Pull for Gens)
Broken: No refresh (drops tokens mid-gen), no JTBD auto-pull.
Fix: Add refresh lib; auto-guide JTBD with QLD prompts.
6. Pipeline/Strategyzer (Validation for Gens)
Broken: Unvalidated JTBD to gens (junk causes "failed generation" per tools).
Fix: Add regex in waterfall; retries on timeouts.
App's launch-ready once UI embed fixed (black screen's the last turd—tools point to URL/embed). Implement; test with curl (tools showed structure works, but key/version critical). Send full logs/screenshots/files