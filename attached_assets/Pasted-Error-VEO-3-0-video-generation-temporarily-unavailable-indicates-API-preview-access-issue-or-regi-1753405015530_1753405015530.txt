Error: "VEO 3.0 video generation temporarily unavailable" indicates API preview access issue or regional unavailability (Veo 3 limited to us-central1). Parse error at line 1619 from invalid VERTEX_AI_SERVICE_ACCOUNT_KEY formatâ€”ensure it's JSON string starting with '{ "type": "service_account", ... }'. Update env var and test parse.

For 401 errors, fix backend session validation in session-manager.ts (check token expiry/refresh).

Quota warning: Reset or increase in QuotaManager.js.

Updated generateVeo3VideoContent (use correct Vertex endpoint/auth):

javascript

Collapse

Wrap

Run

Copy
static async generateVeo3VideoContent(prompt, options = {}) {
  try {
    const { GoogleAuth } = await import('google-auth-library');
    const auth = new GoogleAuth({
      scopes: ['https://www.googleapis.com/auth/cloud-platform']
    });
    const client = await auth.getClient();
    const accessToken = await client.getAccessToken();

    const LOCATION = 'us-central1';
    const PROJECT_ID = process.env.GOOGLE_CLOUD_PROJECT;
    const MODEL_ID = 'veo-3.0-generate-preview';

    const apiUrl = `https://${LOCATION}-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/${LOCATION}/publishers/google/models/${MODEL_ID}:predictLongRunning`;

    const requestBody = {
      instances: [{ prompt }],
      parameters: {
        sampleCount: 1,
        duration: '8',
        aspectRatio: '16:9',
        enableAudio: true,
        quality: 'cinematic'
      }
    };

    const response = await fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${accessToken.token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(requestBody)
    });

    if (!response.ok) throw new Error(await response.text());

    const result = await response.json();
    return { success: true, operationName: result.name, promptUsed: prompt };
  } catch (error) {
    console.error('Veo3 error:', error);
    return { success: false, error: error.message };
  }
}
Apply for Veo preview access if needed. Test with curl first.